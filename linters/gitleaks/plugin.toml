config_version = "0"

[plugins.releases.gitleaks]
github = "zricethezav/gitleaks"
download_type = "targz"
strip_components = 0

[plugins.definitions.gitleaks]
releases = ["gitleaks"]
file_types = ["ALL"]
version_command = "gitleaks version"
config_files = [".gitleaks.toml", ".gitleaks.config"]
recommended = false

[plugins.definitions.gitleaks.drivers.lint]
script = "gitleaks detect --no-git --source=${target} --exit-code=101 -f sarif -r \"${tmpfile}\""
success_codes = [0, 101]
output = "tmpfile"
output_format = "sarif"
cache_results = true
batch = false


# go install github.com/zricethezav/gitleaks/v8@latest

#           in_place: true
#           allow_empty_files: false
#       good_without_config: true

# command: |
#   /Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07/bin/gitleaks detect --no-git --source=.qlty/cache/355ce035f61c6bcd81aae993596d6987.protos --exit-code=101 -f sarif -r /var/folders/tp/5b1zg2jj6819c6x8c81zncc40000gn/T/trunk-501/iaaJGA/wfkc38SIT8U5
# stdin_path: (none)
# run_from: /private/var/folders/tp/5b1zg2jj6819c6x8c81zncc40000gn/T/trunk-501/OzIdqU
# timeout: 10m
# rerun: (cd /private/var/folders/tp/5b1zg2jj6819c6x8c81zncc40000gn/T/trunk-501/OzIdqU; env -i PATH=/Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07/bin:/Users/bhelmkamp/.cache/trunk/tools/go/1.18.3-4eacd594d802731f224bd625049975db/bin GOROOT=/Users/bhelmkamp/.cache/trunk/tools/go/1.18.3-4eacd594d802731f224bd625049975db GOPATH=/Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07 CGO_ENABLED=0 HOME=/Users/bhelmkamp GO111MODULE=on /Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07/bin/gitleaks detect --no-git --source=.qlty/cache/355ce035f61c6bcd81aae993596d6987.protos --exit-code=101 -f sarif -r /var/folders/tp/5b1zg2jj6819c6x8c81zncc40000gn/T/trunk-501/iaaJGA/wfkc38SIT8U5)
# exit_status: exited
# exit_code: 0
# stdout: (none)


# cd /private/var/folders/tp/5b1zg2jj6819c6x8c81zncc40000gn/T/trunk-501/OzIdqU;
# env -i PATH=/Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07/bin:/Users/bhelmkamp/.cache/trunk/tools/go/1.18.3-4eacd594d802731f224bd625049975db/bin \
# GOROOT=/Users/bhelmkamp/.cache/trunk/tools/go/1.18.3-4eacd594d802731f224bd625049975db \
# GOPATH=/Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07 \
# CGO_ENABLED=0 \
# HOME=/Users/bhelmkamp \
# GO111MODULE=on \
# /Users/bhelmkamp/.cache/trunk/tools/gitleaks/8.15.3-c1dbd612f1f0afce9acce42880abca07/bin/gitleaks detect --no-git --source=.qlty/cache/355ce035f61c6bcd81aae993596d6987.protos --exit-code=101 -f sarif -r /var/folders/tp/5b1zg2jj6819c6x8c81zncc40000gn/T/trunk-501/iaaJGA/wfkc38SIT8U5
